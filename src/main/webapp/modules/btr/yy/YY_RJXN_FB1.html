<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8" />
	<title>人均效能</title>

	<link rel="stylesheet" type="text/css" href="../../tools/easyui/themes/default/easyui.css">
	<link rel="stylesheet" type="text/css" href="../../tools/easyui/themes/icon.css">
	<link rel="stylesheet" type="text/css" href="../../dm/common.css">

	<script src="../../tools/easyui/jquery.min.js"></script>
	<script src="../../tools/easyui/jquery.easyui.min.js"></script>
	<script  src="../../tools/highcharts/highcharts.js"></script>
	<script src="../../framework/core.js"></script>
	<script src="../../framework/ajax.js"></script>
	<script src="../../dm/common.js"></script>


	<script type="text/javascript">
	window.onload = function() {
        var globalValiable = window.parent.globalValiable;
        if(globalValiable && globalValiable.data) {
            queryParams = globalValiable.queryParams;
            title = queryParams.param1 +'至' + queryParams.param2 + '日'  +queryParams.param4+'人均效能';
            show(globalValiable.data,queryParams.param1);
            return;
        }
    } 

 
	function show(originData,subtitle) {
		var total = 0;
		var datar = [];
		var datar2 = [];
		var datar3 = [];
		var dataload = [];
		var label = [];
		var showDay=[];
		var dataDay=[];
		var weekday;
		var maxdata=0;
		var maxdatar=0;
		var maxdataw=0;
		var mindata=100;
		var scaledata=0;
				
		for(var i = 0; i < originData.length; i++) {
			var brst = originData[i]["人均效能"];
			var brst2 = originData[i]["人员"];
			var brst3 = originData[i]["货量"];
			
			var routine = originData[i]["日期"];
			if (maxdata<brst) {
				maxdata=brst
			}
			if (maxdatar<brst2) {
				maxdatar=brst2
			}
			if (maxdataw<brst3) {
				maxdataw=brst3
			}
			if (mindata>brst) {
				mindata=brst
			}
			weekday = "天一二三四五六".charAt(new Date(routine).getDay());
			if (i % Math.round(originData.length/10) == 0){
				showDay[i] = routine + '\n' + "星期" + weekday;
			}
			else{
				showDay[i] = ' ';
			}
			scaledata=Math.round(maxdata)*100  + 0;

			total += brst;
			datar[i] = brst;
			datar2[i] = brst2;
			datar3[i] = brst3;
			dataDay[i] = routine + '\n' + "星期" + weekday;
			label[i] = routine;
		}
$(function () {
    $('#container').highcharts({
        chart: {
			height:600,
            zoomType: 'xy'
        },
        title: {
            text: title
        },
        subtitle: {
            text: '区间人均效能最大值：'+maxdata+'				区间人均效能最小值：'+mindata
        },
        xAxis: [{
            categories: showDay
        }],
        yAxis: [{ // Secondary yAxis
            gridLineWidth: 0,
            title: {
                text: '人员(人)',
                style: {
                    color: '#4572A7'
                }
            },
            labels: {
                formatter: function() {
                    return this.value +'';
                },
                style: {
                    color: '#4572A7'
                }
            }

        }, 
		{ // Primary yAxis
            labels: {
                formatter: function() {
                    return this.value +'';
                },
                style: {
                    color: '#89A54E'
                }
            },
            title: {
                text: '货量(吨)',
                style: {
                    color: '#89A54E'
                }
            },
            opposite: true

        }, { // Tertiary yAxis
            gridLineWidth: 0,
            title: {
                text: '人均效能（吨/人）',
                style: {
                    color: '#AA4643'
                }
            },
            labels: {
                formatter: function() {
                    return this.value +'';
                },
                style: {
                    color: '#AA4643'
                }
            },
            opposite: true
        }],
        tooltip: {
            shared: true
        },
        /*legend: {
            layout: 'vertical',
            align: 'left',
            x: 120,
            verticalAlign: 'top',
            y: 80,
            floating: true,
            backgroundColor: '#FFFFFF'
        },*/
        series: [{
            name: '人员',
            color: '#4572A7',
            type: 'column',
            
            data: datar2,
            tooltip: {
                valueSuffix: ''
            }

        }, {
            name: '货量',
            type: 'column',
            color: '#89A54E',
           	yAxis: 1,
            data: datar3,
            marker: {
                enabled: false
            },
            
            tooltip: {
                valueSuffix: ''
            }

        }, {
            name: '人均效能',
            color: '#AA4643',
            type: 'spline',
			yAxis: 2,
            data: datar,
            tooltip: {
                valueSuffix: ''
            }
        }]
    });
});				   
                    
	}
   
	</script>
</head>

<body>
<div id='container'></div>


</body>
</html>
